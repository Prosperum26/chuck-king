<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Chuck King - NPC Dialog Test</title>
    <link rel="stylesheet" href="styles/main.css">
</head>
<body>
    <!-- API Key Input Modal -->
    <div id="api-key-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚öôÔ∏è C·∫•u H√¨nh AI API</h2>
                <p style="font-size: 0.85em; margin-top: 5px; color: #666;">
                    T√πy ch·ªçn - ƒê·ªÉ tr·ªëng ƒë·ªÉ test dialog v·ªõi hardcoded messages
                </p>
            </div>
            <div class="modal-body">
                <p class="modal-description">
                    ü§ñ <strong>AI API</strong> s·∫Ω sinh ra n·ªôi dung dialog v√† c√¢u tr√™u ch·ªçc AI ng·∫´u nhi√™n.
                    <br><br>
                    <strong>Ch∆∞a c√≥ API Key?</strong>
                    <a href="docs/GET_API_KEY.md" target="_blank" style="color: #0066cc; text-decoration: underline;">
                        üìñ Xem h∆∞·ªõng d·∫´n l·∫•y API Key
                    </a>
                </p>

                <div class="form-group">
                    <label for="api-endpoint">
                        üîó AI API Endpoint:
                        <span title="B·∫°n c√≥ th·ªÉ d√πng OpenAI ho·∫∑c OpenAI-compatible endpoint" style="cursor: help; color: #0066cc;">‚ìò</span>
                    </label>
                    <input
                        type="text"
                        id="api-endpoint"
                        class="form-input"
                        placeholder="OpenAI: https://api.openai.com/v1/chat/completions | Gemini: https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent"
                        value="https://api.openai.com/v1/chat/completions"
                        title="Endpoint ƒë·ªÉ g·ªçi Chat Completions API">
                    <small style="color: #666; margin-top: 3px; display: block;">
                        üí° Gemini: d√πng endpoint d·∫°ng ...:generateContent v√† nh·∫≠p API key (key s·∫Ω g·ª≠i qua header x-goog-api-key)
                    </small>
                </div>

                <div class="form-group">
                    <label for="api-key">
                        üîë API Key:
                        <span title="OpenAI/OpenAI-compatible th∆∞·ªùng d√πng Bearer token; Gemini d√πng key query param" style="cursor: help; color: #0066cc;">‚ìò</span>
                    </label>
                    <input
                        type="password"
                        id="api-key"
                        class="form-input"
                        placeholder="OpenAI key ho·∫∑c Gemini key"
                        autocomplete="off">
                    <small style="color: #666; margin-top: 3px; display: block;">
                        ‚ö†Ô∏è Gi·ªØ b√≠ m·∫≠t - Kh√¥ng share v·ªõi ai
                    </small>
                </div>

                <div id="api-status" class="api-status hidden"></div>

                <button id="test-api-btn" class="btn btn-secondary">üîç Ki·ªÉm Tra API</button>
            </div>

            <div class="modal-footer">
                <button id="close-api-btn" class="btn btn-outline">ƒê√≥ng</button>
                <button id="save-api-btn" class="btn btn-primary">L∆∞u &amp; d√πng API cho dialog</button>
            </div>
        </div>
    </div>

    <div id="dialog-test-container" class="dialog-test-container">
        <div class="dialog-test-header">
            <div class="dialog-test-header-left">
                <h1>NPC Dialog / Taunt Test</h1>
                <p class="dialog-test-subtitle">
                    Test dialog m·∫∑c ƒë·ªãnh ho·∫∑c t·ª´ AI API, v·ªõi hi·ªáu ·ª©ng hi·ªán ch·ªØ d·∫ßn.
                </p>
            </div>
            <div class="dialog-test-header-right">
                <button id="toggle-api-btn" class="control-btn" title="B·∫≠t/t·∫Øt c·ª≠a s·ªï c·∫•u h√¨nh API">‚öôÔ∏è API</button>
                <span id="api-mode-label" class="api-mode-label">Mode: Hardcoded default</span>
            </div>
        </div>

        <div class="dialog-test-controls">
            <div class="form-group">
                <label for="dialog-key-select">Ch·ªçn lo·∫°i dialog:</label>
                <select id="dialog-key-select" class="form-input">
                    <option value="intro">Intro</option>
                    <option value="stage1">Stage 1</option>
                    <option value="stage2">Stage 2</option>
                    <option value="stage3">Stage 3</option>
                    <option value="stage4">Stage 4</option>
                    <option value="ending">Ending</option>
                </select>
            </div>
            <div class="dialog-test-buttons">
                <button id="show-dialog-btn" class="btn btn-primary">‚ñ∂Ô∏è Hi·ªÉn th·ªã dialog</button>
                <button id="show-taunt-btn" class="btn btn-secondary">üí¢ Test c√¢u tr√™u (death)</button>
            </div>
            <p class="dialog-test-hint">
                N·∫øu ch∆∞a c·∫•u h√¨nh API, h·ªá th·ªëng s·∫Ω lu√¥n d√πng n·ªôi dung m·∫∑c ƒë·ªãnh (default). Khi c√≥ API h·ª£p l·ªá,
                dialog v√† c√¢u tr√™u s·∫Ω d√πng AI output (khi API tr·∫£ v·ªÅ h·ª£p l·ªá).
            </p>
        </div>

        <div id="ui-overlay">
            <div id="npc-dialog-box" class="npc-dialog-box hidden">
                <div class="npc-dialog-header">
                    <span id="npc-name" class="npc-name">NPC</span>
                    <button id="npc-dialog-close-btn" class="npc-dialog-close-btn" title="ƒê√≥ng">√ó</button>
                </div>
                <div class="npc-dialog-body">
                    <div id="npc-dialog-text" class="npc-dialog-text">
                        Xin ch√†o!
                    </div>
                </div>
                <div class="npc-dialog-footer"></div>
            </div>
        </div>
    </div>

    <script type="module" src="./js/dialog-test.js"></script>
</body>
</html>

